SELECT 
    c.consultation_id,
    c.patient_id,
    p.name AS patient_name,
    c.chief_complaint,
    c.department,
    c.status,
    c.current_step,
    c.created_at
FROM 
    consultations c
JOIN 
    patients p ON c.patient_id = p.patient_id
WHERE p.name ilike '%{{data_table.searchText || ""}}%'
ORDER BY "created_at" {{data_table.sortOrder.order || 'DESC'}}
LIMIT {{data_table.pageSize}}
OFFSET {{(data_table.pageNo - 1) * data_table.pageSize}};